{% for node in nodes %}
    <li class="rounded border bg-white p-4 shadow-sm">
        <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div>
                <h3 class="text-lg font-semibold">{{ node.deck.name }}</h3>
                {% if node.deck.description %}
                    <p class="text-sm text-gray-600 mt-1">{{ node.deck.description }}</p>
                {% endif %}
                <p class="text-xs text-gray-400 mt-2">Cards (including children): {{ node.total_cards }}</p>
                {% if node.deck.parent %}
                    <p class="text-xs text-gray-400">Parent: {{ node.deck.parent.full_path }}</p>
                {% endif %}
            </div>
            <div class="flex flex-wrap gap-2">
                <a href="{% url 'review:today' %}?deck_id={{ node.deck.id }}" class="rounded bg-indigo-600 px-3 py-2 text-sm font-semibold text-white hover:bg-indigo-700">Review</a>
                <a href="{% url 'cards:list' %}?deck={{ node.deck.id }}" class="rounded border border-indigo-200 px-3 py-2 text-sm text-indigo-600 hover:bg-indigo-50">Browse</a>
                <a href="{% url 'decks:edit' node.deck.id %}" class="rounded border border-slate-200 px-3 py-2 text-sm text-slate-600 hover:bg-slate-50">Rename</a>
                <form method="post" action="{% url 'decks:delete' node.deck.id %}" hx-post="{% url 'decks:delete' node.deck.id %}" hx-target="#deck-list" hx-swap="innerHTML" onsubmit="return confirm('Delete deck {{ node.deck.name }}?');">
                    {% csrf_token %}
                    <button type="submit" class="rounded border border-red-200 px-3 py-2 text-sm text-red-600 hover:bg-red-50">Delete</button>
                </form>
            </div>
        </div>
        {% if node.children %}
            <ul class="mt-3 space-y-3 border-l border-gray-200 pl-4">
                {% include 'core/decks/partials/deck_nodes.html' with nodes=node.children %}
            </ul>
        {% endif %}
    </li>
{% endfor %}
